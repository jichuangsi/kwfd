<extend name="Public/basenew"/>

<block name="body">
<style>
/***
Custom tabs
***/
/* In BS3.0.0 tabbable class was removed. We had to added it back */
.tabbable:before,
.tabbable:after {
  content: " ";
  display: table; }

.tabbable:after {
  clear: both; }

.tabbable-custom {
  margin-bottom: 15px;
  padding: 0px;
  overflow: hidden;
  /* justified tabs */
  /* boxless tabs */
  /* below justified tabs */
  /* full width tabs */
  /* below tabs */ }
  .tabbable-custom > .nav-tabs {
    border: none;
    margin: 0px; }
    .tabbable-custom > .nav-tabs > li {
      margin-right: 2px;
      border-top: 2px solid transparent; }
      .tabbable-custom > .nav-tabs > li > a {
        margin-right: 0;
        -webkit-border-radius: 0;
        -moz-border-radius: 0;
        -ms-border-radius: 0;
        -o-border-radius: 0;
        border-radius: 0; 
		color:#555555;}
        .tabbable-custom > .nav-tabs > li > a:hover {
          background: none;
		  color:#000000;
          border-color: transparent; }
      .tabbable-custom > .nav-tabs > li.active {
        border-top: 3px solid #949dd1;
		color:#555555;
        margin-top: 0;
        position: relative; }
        .tabbable-custom > .nav-tabs > li.active > a {
          border-top: none !important;
          font-weight: 400;
          -webkit-border-radius: 0;
          -moz-border-radius: 0;
          -ms-border-radius: 0;
          -o-border-radius: 0;
          border-radius: 0; }
          .tabbable-custom > .nav-tabs > li.active > a:hover {
            -webkit-border-radius: 0;
            -moz-border-radius: 0;
            -ms-border-radius: 0;
            -o-border-radius: 0;
            border-radius: 0;
            border-top: none;
            background: #fff;
            border-color: #d4d4d4 #d4d4d4 transparent; }
  .tabbable-custom > .tab-content {
    background-color: #fff;
    border: 1px solid #ddd;
    padding: 10px;
    -webkit-border-radius: 0 0 4px 4px;
    -moz-border-radius: 0 0 4px 4px;
    -ms-border-radius: 0 0 4px 4px;
    -o-border-radius: 0 0 4px 4px;
    border-radius: 0 0 4px 4px; }
  .tabbable-custom.nav-justified > .tab-content {
    margin-top: -1px; }
  .tabbable-custom.boxless > .tab-content {
    padding: 15px 0;
    border-left: none;
    border-right: none;
    border-bottom: none; }
  .tabbable-custom.tabs-below.nav-justified .tab-content {
    margin-top: 0px;
    margin-bottom: -2px;
    -webkit-border-radius: 4px 4px 0 0;
    -moz-border-radius: 4px 4px 0 0;
    -ms-border-radius: 4px 4px 0 0;
    -o-border-radius: 4px 4px 0 0;
    border-radius: 4px 4px 0 0; }
  .tabbable-custom.tabbable-full-width > .nav-tabs > li > a {
    color: #424242;
    font-size: 15px;
    padding: 9px 15px; }
  .tabbable-custom.tabbable-full-width > .tab-content {
    padding: 15px 0;
    border-left: none;
    border-right: none;
    border-bottom: none; }
  .tabbable-custom.tabs-below .nav-tabs > li > a {
    border-top: none;
    border-bottom: 2px solid transparent;
    margin-top: -1px; }
  .tabbable-custom.tabs-below .nav-tabs > li.active {
    border-top: none;
    border-bottom: 3px solid #d12610;
    margin-bottom: 0;
    position: relative; }
    .tabbable-custom.tabs-below .nav-tabs > li.active > a {
      border-bottom: none; }
      .tabbable-custom.tabs-below .nav-tabs > li.active > a:hover {
        background: #fff;
        border-color: #d4d4d4 #d4d4d4 transparent; }

.tabbable-custom.tabbable-noborder > .nav-tabs > li > a {
  border: 0; }

.tabbable-custom.tabbable-noborder .tab-content {
  border: 0; }

.portlet:not(.light) .tabbable-line {
  padding-top: 15px; }

.tabbable-line > .nav-tabs {
  border: none;
  margin: 0px; }
  .tabbable-line > .nav-tabs > li {
    margin: 0; }
    .tabbable-line > .nav-tabs > li > a {
      background: none !important;
      border: 0;
      margin: 0;
      padding-left: 15px;
      padding-right: 15px;
      color: #737373; }
      .tabbable-line > .nav-tabs > li > a > i {
        color: #a6a6a6; }
    .tabbable-line > .nav-tabs > li.active {
      background: none;
      border-bottom: 4px solid #36c6d3;
      position: relative; }
      .tabbable-line > .nav-tabs > li.active > a {
        border: 0;
        color: #333; }
        .tabbable-line > .nav-tabs > li.active > a > i {
          color: #404040; }
    .tabbable-line > .nav-tabs > li.open,
    .tabbable-line > .nav-tabs > li:hover {
      background: none;
      border-bottom: 4px solid #9fe4ea; }
      .tabbable-line > .nav-tabs > li.open > a,
      .tabbable-line > .nav-tabs > li:hover > a {
        border: 0;
        background: none !important;
        color: #333; }
        .tabbable-line > .nav-tabs > li.open > a > i,
        .tabbable-line > .nav-tabs > li:hover > a > i {
          color: #a6a6a6; }
      .tabbable-line > .nav-tabs > li.open .dropdown-menu,
      .tabbable-line > .nav-tabs > li:hover .dropdown-menu {
        margin-top: 0px; }

.tabbable-line > .tab-content {
  margin-top: 0;
  border: 0;
  border-top: 1px solid #eef1f5;
  padding: 30px 0; }
  .page-container-bg-solid .tabbable-line > .tab-content {
    border-top: 1px solid #dae2ea; }
  .portlet .tabbable-line > .tab-content {
    padding-bottom: 0; }

.tabbable-line.tabs-below > .nav-tabs > li {
  border-top: 4px solid transparent; }
  .tabbable-line.tabs-below > .nav-tabs > li > a {
    margin-top: 0; }
  .tabbable-line.tabs-below > .nav-tabs > li:hover {
    border-bottom: 0;
    border-top: 4px solid #fbdcde; }
  .tabbable-line.tabs-below > .nav-tabs > li.active {
    margin-bottom: -2px;
    border-bottom: 0;
    border-top: 4px solid #ed6b75; }

.tabbable-line.tabs-below > .tab-content {
  margin-top: -10px;
  border-top: 0;
  border-bottom: 1px solid #eee;
  padding-bottom: 15px; }

.portlet .tabbable-bordered {
  margin-top: 20px; }

.tabbable-bordered .nav-tabs {
  margin-bottom: 0;
  border-bottom: 0; }

.tabbable-bordered .tab-content {
  padding: 30px 20px 20px 20px;
  border: 1px solid #ddd;
  background: #ffffff; }

</style>
    <div class="page-bar" style="display:none">
        <ul class="page-breadcrumb">
            <li>
                <a href="{:U('Admin/Index/index')}">首页  </a>
                <i class="fa fa-circle"></i>
            </li>
            <li>
                <span>{$title}</span>
            </li>
        </ul>
        <div class="page-toolbar">
            <include file="Public/_addTo"/>
        </div>
    </div>

    <div class="main-title">
        <h2>{$title}            <if condition="$suggest">（{$suggest}）</if></h2>
    </div>

    <div class="with-padding">
        <div class="tab-wrap tabbable-custom" style="margin-bottom: 5px">
            <ul class="nav nav-tabs group_nav">
                <volist name="group" id="vGroup">
                    <li class="<if condition="
                    $i eq 1">active</if>"><a href="javascript:">{$key}</a></li>
                </volist>
            </ul>
            <div class="tab-content">
                <form action="{$savePostUrl}" method="post" class="form-horizontal">
                    <php>if($group){</php>
                    <!--看板-->
                    <volist name="group" id="vGroup">
                        <div class="group_list" style="<if condition='$i neq 1'>display: none;</if>">
                            <volist name="keyList" id="field">
                                <php>if(in_array($field['name'],$vGroup)||(is_array($field['name'])&&in_array(implode('|', $field['name']),$vGroup))){</php>
                                <include file="Builder/_key"/>
                                <php>}</php>
                            </volist>
                        </div>
                    </volist>

                    <php>}else{</php>
                    <volist name="keyList" id="field">
                        <include file="Builder/_key"/>
                    </volist>
                    <php>}</php>
                    <br/>
                    <div class="form-item">
                        <volist name="buttonList" id="button">
                            <button {$button.attr}>&nbsp; &nbsp; &nbsp; {$button.title}&nbsp; &nbsp; &nbsp; </button>&nbsp; &nbsp; &nbsp; 
                        </volist>
                    </div>
                </form>
            </div>
        </div>
    </div>

</block>

<block name="script">
    <if condition="$chosen_select2">
        <link rel="stylesheet" href="__ALTE__/plugins/select2/select2.min.css">
        <script src="__ALTE__/plugins/select2/select2.full.min.js"></script>
        <script>
            $(function(){
                $(".select2").select2();
            })
        </script>
    </if>
    <if condition="$has_nestable">
        <link href="__BTS__/plugins/jquery-nestable/jquery.nestable.css" rel="stylesheet" type="text/css"/>
        <script src="__BTS__/plugins/jquery-nestable/jquery.nestable.js" type="text/javascript"></script>
        <script src="__BTS__/js/ui-nestable.min.js" type="text/javascript"></script>
        <script>
            $('.nestables').find('.dd').nestable({
                maxDepth:1
            });
            $('.nestable_list_one').on('change',function(){
                var obj=$(this).parents('.nestables');
                var nestable=new Array();
                obj.find('.portlet').each(function(index,element){
                    if ($(element).data('id')) {
                        nestable[index] =  new Object();
                        nestable[index]['data-id'] =  $(element).data('id');
                        nestable[index]['title'] =  $(element).data('title');
                        nestable[index]['items'] =  $(element).find('.dd').nestable('serialize');
                        nestable[index]['items'].forEach(function(li){
                            li['data-id']=li['id'];
                        });
                    }
                });
                var nestable_str=JSON.stringify(nestable);
                var flag=obj.data('name');
                $('[name="'+flag+'"]').val(nestable_str);
            });
        </script>
    </if>

    <if condition="$importDatetimePicker">
        <link href="__BTS__/plugins/datetimepicker/datetimepicker.css" rel="stylesheet" type="text/css">
        <script type="text/javascript" src="__BTS__/plugins/datetimepicker/datetimepicker.min.js"></script>

        <script>
            $('.form-datetime').datetimepicker({
                language: "zh-CN",
                autoclose: true,
                format: 'yyyy-mm-dd hh:ii'
            });
            $('.form-date').datetimepicker({
                language: "zh-CN",
                minView: 2,
                autoclose: true,
                format: 'yyyy-mm-dd'
            });
            $('.form-time').datetimepicker({
                language: "zh-CN",
                minView: 0,
                startView:1,
                autoclose: true,
                format: 'hh:ii'
            });
            $('.time').change(function () {
                var fieldName = $(this).attr('data-field-name');
                var dateString = $(this).val();
                var date = new Date(dateString);
                var timestamp = date.getTime();
                $('[name=' + fieldName + ']').val(Math.floor(timestamp / 1000));
            });
        </script>
    </if>
    <if condition="$colorPicker">
        <script type="text/javascript" src="__JS__/jquery.simple-color.js"></script>
        <script>
            $(function(){
                $('.simple_color_callback').simpleColor({
                    boxWidth:20,
                    cellWidth: 20,
                    cellHeight: 20,
                    chooserCSS:{ 'z-index': 500 },
                    displayCSS: { 'border': 0 ,
                        'width': '32px',
                        'height': '32px',
                        'margin-top': '-32px'
                    },
                    onSelect: function(hex, element) {
                        $('#tw_color').val('#'+hex);
                    }
                });
                $('.simple_color_callback').show();
                $('.simpleColorContainer').css('margin-left','105px');
                $('.simpleColorDisplay').css('border','1px solid #DFDFDF');
            });
            var setColorPicker=function(obj){
                var color=$(obj).val();
                $(obj).parents('.color-picker').find('.simpleColorDisplay').css('background',color);
            }
        </script>
    </if>

    <if condition="$importCheckBox">
        <script>
            $(function () {
                function implode(x, list) {
                    var result = "";
                    for (var i = 0; i < list.length; i++) {
                        if (result == "") {
                            result += list[i];
                        } else {
                            result += ',' + list[i];
                        }
                    }
                    return result;
                }

                $('.oneplus-checkbox').change(function (e) {
                    var fieldName = $(this).attr('data-field-name');
                    var checked = $('.oneplus-checkbox[data-field-name=' + fieldName + ']:checked');
                    var result = [];
                    for (var i = 0; i < checked.length; i++) {
                        var checkbox = $(checked.get(i));
                        result.push(checkbox.attr('value'));
                    }
                    result = implode(',', result);
                    $('.oneplus-checkbox-hidden[data-field-name=' + fieldName + ']').val(result);
                });
            })
        </script>
    </if>

    <script type="text/javascript">
        $(function () {
            $('.group_nav li a').click(function () {
                $('.group_list').hide();
                $('.group_list').eq($(".group_nav li a").index(this)).show();
                $('.group_nav li').removeClass('active');
                $(this).parent().addClass('active');
				window.location.hash=new Date().getTime(); 
            })
        })
        Think.setValue("type", {$info.type|default=0});
        Think.setValue("group", {$info.group|default=0});
        //导航高亮
        highlight_subnav('{:U('Config / index')}');
    </script>
    <link type="text/css" rel="stylesheet" href="__PUBLIC__/js/ext/magnific/magnific-popup.css"/>
    <script type="text/javascript" src="__PUBLIC__/js/ext/magnific/jquery.magnific-popup.min.js"></script>

    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/js/ext/webuploader/js/webuploader.js"></script>
    <link href="__PUBLIC__/js/ext/webuploader/css/webuploader.css" type="text/css" rel="stylesheet">


    <script>
        $(document).ready(function () {
            $('.popup-gallery').each(function () { // the containers for all your galleries
                $(this).magnificPopup({
                    delegate: 'a',
                    type: 'image',
                    tLoading: '{:L("_LOADING_")}#%curr%...',
                    mainClass: 'mfp-img-mobile',
                    gallery: {
                        enabled: true,
                        navigateByImgClick: true,
                        preload: [0, 1] // Will preload 0 - before current, and 1 after the current image

                    },
                    image: {
                        tError: '<a href="%url%">{:L("_PICTURE_")}#%curr%</a>{:L("_COULD_NOT_BE_LOADED_")}',
                        titleSrc: function (item) {
                            /*           return item.el.attr('title') + '<small>by Marsel Van Oosten</small>';*/
                            return '';
                        },
                        verticalFit: true
                    }
                });
            });
            {$myJs}
        });
    </script>
</block>
